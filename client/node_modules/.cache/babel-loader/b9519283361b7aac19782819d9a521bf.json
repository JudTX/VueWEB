{"remainingRequest":"E:\\全栈\\project\\node\\node-app\\client\\node_modules\\thread-loader\\dist\\cjs.js!E:\\全栈\\project\\node\\node-app\\client\\node_modules\\babel-loader\\lib\\index.js!E:\\全栈\\project\\node\\node-app\\client\\src\\http.js","dependencies":[{"path":"E:\\全栈\\project\\node\\node-app\\client\\src\\http.js","mtime":1574759329669},{"path":"E:\\全栈\\project\\node\\node-app\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\全栈\\project\\node\\node-app\\client\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\全栈\\project\\node\\node-app\\client\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7CmltcG9ydCB7IExvYWRpbmcsIE1lc3NhZ2UgfSBmcm9tICdlbGVtZW50LXVpJzsKaW1wb3J0IHJvdXRlciBmcm9tICIuL3JvdXRlci9pbmRleCI7CnZhciBsb2FkaW5nOwoKZnVuY3Rpb24gc3RhcnRMb2FkaW5nKCkgewogIGxvYWRpbmcgPSBMb2FkaW5nLnNlcnZpY2UoewogICAgbG9jazogdHJ1ZSwKICAgIHRleHQ6ICfmi7zlkb3liqDovb3kuK0nLAogICAgYmFja2dyb3VuZDogJ3JnYmEoMCwwLDAsMC43KScKICB9KTsKfQoKZnVuY3Rpb24gZW5kTG9hZGluZygpIHsKICBsb2FkaW5nLmNsb3NlKCk7Cn0gLy/or7fmsYLmi6bmiKoKCgpheGlvcy5pbnRlcmNlcHRvcnMucmVxdWVzdC51c2UoZnVuY3Rpb24gKGNvbmZpZykgewogIHN0YXJ0TG9hZGluZygpOwoKICBpZiAobG9jYWxTdG9yYWdlLlRva2VuKSB7CiAgICAvL+iuvue9rue7n+S4gOeahOivt+axguWktAogICAgY29uZmlnLmhlYWRlcnMuQXV0aG9yaXphdGlvbiA9IGxvY2FsU3RvcmFnZS5Ub2tlbjsKICB9CgogIHJldHVybiBjb25maWc7Cn0sIGZ1bmN0aW9uIChlcnJvcikgewogIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7Cn0pOyAvL+WTjeW6lOaLpuaIqgoKYXhpb3MuaW50ZXJjZXB0b3JzLnJlc3BvbnNlLnVzZShmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAvL+e7k+adn+WKoOi9veWKqOeUuwogIGVuZExvYWRpbmcoKTsKICByZXR1cm4gcmVzcG9uc2U7Cn0sIGZ1bmN0aW9uIChlcnJvcikgewogIGVuZExvYWRpbmcoKTsKICBNZXNzYWdlLmVycm9yKGVycm9yLnJlc3BvbnNlLmRhdGEpOyAvL+iOt+WPlumUmeivr+eKtuaAgeeggQoKICB2YXIgc3RhdHVzID0gZXJyb3IucmVzcG9uc2Uuc3RhdHVzOwoKICBpZiAoc3RhdHVzID09IDQwMSkgewogICAgTWVzc2FnZS5lcnJvcigiVG9rZW7lpLHmlYjvvIzor7fph43mlrDnmbvlvZUhIik7IC8v5riF6ZmkdG9rZW4KCiAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgnVG9rZW4nKTsgLy/ot7Povazoh7PnmbvlvZXnlYzpnaIKCiAgICByb3V0ZXIucHVzaCgnL2xvZ2luJyk7CiAgfQoKICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpOwp9KTsKZXhwb3J0IGRlZmF1bHQgYXhpb3M7"},{"version":3,"sources":["E:/全栈/project/node/node-app/client/src/http.js"],"names":["axios","Loading","Message","router","loading","startLoading","service","lock","text","background","endLoading","close","interceptors","request","use","config","localStorage","Token","headers","Authorization","error","Promise","reject","response","data","status","removeItem","push"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAAQC,OAAR,EAAgBC,OAAhB,QAA8B,YAA9B;AACA,OAAOC,MAAP;AAEA,IAAIC,OAAJ;;AACA,SAASC,YAAT,GAAuB;AACrBD,EAAAA,OAAO,GAAGH,OAAO,CAACK,OAAR,CAAgB;AACxBC,IAAAA,IAAI,EAAE,IADkB;AAExBC,IAAAA,IAAI,EAAE,OAFkB;AAGxBC,IAAAA,UAAU,EAAE;AAHY,GAAhB,CAAV;AAKD;;AACD,SAASC,UAAT,GAAqB;AACnBN,EAAAA,OAAO,CAACO,KAAR;AACD,C,CAED;;;AACAX,KAAK,CAACY,YAAN,CAAmBC,OAAnB,CAA2BC,GAA3B,CACE,UAAAC,MAAM,EAAI;AACVV,EAAAA,YAAY;;AACZ,MAAGW,YAAY,CAACC,KAAhB,EAAsB;AACpB;AACAF,IAAAA,MAAM,CAACG,OAAP,CAAeC,aAAf,GAA+BH,YAAY,CAACC,KAA5C;AACD;;AACD,SAAOF,MAAP;AACD,CARD,EAQE,UAAAK,KAAK,EAAG;AACR,SAAOC,OAAO,CAACC,MAAR,CAAeF,KAAf,CAAP;AACD,CAVD,E,CAWA;;AACApB,KAAK,CAACY,YAAN,CAAmBW,QAAnB,CAA4BT,GAA5B,CAAgC,UAAAS,QAAQ,EAAG;AACzC;AACAb,EAAAA,UAAU;AACV,SAAOa,QAAP;AACD,CAJD,EAIE,UAAAH,KAAK,EAAG;AACRV,EAAAA,UAAU;AACVR,EAAAA,OAAO,CAACkB,KAAR,CAAcA,KAAK,CAACG,QAAN,CAAeC,IAA7B,EAFQ,CAGR;;AAHQ,MAIAC,MAJA,GAIWL,KAAK,CAACG,QAJjB,CAIAE,MAJA;;AAKR,MAAGA,MAAM,IAAI,GAAb,EAAiB;AACfvB,IAAAA,OAAO,CAACkB,KAAR,CAAc,gBAAd,EADe,CAEf;;AACAJ,IAAAA,YAAY,CAACU,UAAb,CAAwB,OAAxB,EAHe,CAIf;;AACAvB,IAAAA,MAAM,CAACwB,IAAP,CAAY,QAAZ;AACD;;AACD,SAAON,OAAO,CAACC,MAAR,CAAeF,KAAf,CAAP;AACD,CAjBD;AAkBA,eAAepB,KAAf","sourcesContent":["import axios from 'axios'\r\nimport {Loading,Message} from 'element-ui'\r\nimport router from './router/index'\r\n\r\nlet loading;\r\nfunction startLoading(){\r\n  loading = Loading.service({\r\n    lock: true,\r\n    text: '拼命加载中',\r\n    background: 'rgba(0,0,0,0.7)'\r\n  });\r\n}\r\nfunction endLoading(){\r\n  loading.close();\r\n}\r\n\r\n//请求拦截\r\naxios.interceptors.request.use(\r\n  config => {\r\n  startLoading();\r\n  if(localStorage.Token){\r\n    //设置统一的请求头\r\n    config.headers.Authorization = localStorage.Token;\r\n  }\r\n  return config;\r\n},error =>{\r\n  return Promise.reject(error);\r\n});\r\n//响应拦截\r\naxios.interceptors.response.use(response =>{\r\n  //结束加载动画\r\n  endLoading();\r\n  return response;\r\n},error =>{\r\n  endLoading();\r\n  Message.error(error.response.data);\r\n  //获取错误状态码\r\n  const { status } = error.response;\r\n  if(status == 401){\r\n    Message.error(\"Token失效，请重新登录!\");\r\n    //清除token\r\n    localStorage.removeItem('Token');\r\n    //跳转至登录界面\r\n    router.push('/login');\r\n  }\r\n  return Promise.reject(error);\r\n})\r\nexport default axios;"]}]}